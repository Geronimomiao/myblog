---
title: React å­¦ä¹ ç¬”è®° 1
---

## åŸºæœ¬æ€æƒ³

åœ¨ React ä¸­ï¼Œç•Œé¢å®Œå…¨ç”±æ•°æ®é©±åŠ¨ï¼›UI=f(data)
åœ¨ React ä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯ç»„ä»¶
props æ˜¯ React ç»„ä»¶ä¹‹é—´é€šè®¯çš„åŸºæœ¬æ–¹å¼

å°†ç•Œé¢æŠ½è±¡æŠ½è±¡ä¸ºçŠ¶æ€å’Œè§†å›¾ åªéœ€è¦å®šä¹‰æ¯ä¸ªçŠ¶æ€å¯¹åº”çš„è§†å›¾å°±è¡Œ

## JSX

JSX æ˜¯ä¸€ç§æ‰©å±• XML è¯­è¨€ å·²æ¯”è¾ƒå‹å¥½çš„æ–¹å¼ ä»£æ›¿å†™å„ç§å‡½æ•°è°ƒç”¨ å„ç§ new æ“ä½œ åŒ–ç®€äº†å®ä¾‹åŒ–ç»„ä»¶çš„è¿‡ç¨‹

```js
// jsx æœ€ç»ˆç¼–è¯‘ç»“æœ
React.createElement(
  type, // HTMLæ ‡ç­¾/Reactç»„ä»¶
  [props], // ä¼ ç»™ç»„ä»¶çš„å±æ€§
  [...children] // è¿™ä¸ªå…ƒç´ çš„å­å…ƒç´ 
);
```

## ç»„ä»¶

- æœ‰è¾“å…¥(props) è¾“å‡º(render) å’Œ è‡ªå·±çš„çŠ¶æ€(state)
- å¯ä»¥åˆ†ä¸º æœ‰çŠ¶æ€(äº¤äº’ç±») æ— çŠ¶æ€(çº¯å±•ç¤ºç±») 2 ç±»

- props(å±æ€§) æ˜¯åªè¯»(åªèƒ½è¯»å– ä¸èƒ½è¿›è¡Œæ›´æ”¹)
  - å¯¹äºåŠŸç”¨ç»„ä»¶ åº”è¯¥ä¸ºå±æ€§æ·»åŠ é»˜è®¤å€¼ ç»„ä»¶æ‰ä¼šæ›´å¥å£®
  - å¯¹äºä¸šåŠ¡ç»„ä»¶ å»ºè®®ä¸ºç»„ä»¶æ·»åŠ é»˜è®¤å€¼

- åˆ·æ–°é¡µé¢ä¸ä¼šä¿å­˜çš„ä¿¡æ¯å°±æ˜¯è‡ªèº«çŠ¶æ€

- React é€šè¿‡ JSX è¯­æ³•å£°æ˜ UI ç•Œé¢, å°† UI ç•Œé¢å’Œå®ƒçš„é€»è¾‘å°è£…åˆ°åŒä¸€ä¸ª JS æ–‡ä»¶ä¸­
  - ç»„ä»¶æ˜¯ React çš„æ ¸å¿ƒ(props state å®Œæˆè‡ªèº« UI çš„æ¸²æŸ“)
    - å¤–éƒ¨æ¥å£ props 
    - å†…éƒ¨æ¥å£ state  

#### ç”Ÿå‘½å‘¨æœŸ

- æŒ‚è½½
  - constructor()
  - componentWillMount()
  - render()
  - componentDidMount()
- æ›´æ–°
  - çˆ¶ç»„ä»¶æ›´æ–°
    - componentWillReceiveProps()
    - shouldComponentUpdate()
    - componentWillUpdate()
    - render()
    - componentDidUpdate()
  - è‡ªèº«çŠ¶æ€å˜åŒ–(è°ƒç”¨ setState)
    - shouldComponentUpdate()
    - componentWillUpdate()
    - render()
    - componentDidUpdate()
  - è‡ªèº«å¼ºåˆ¶æ›´æ–°(forceUpdate)
    - componentWillUpdate()
    - render()
    - componentDidUpdate()
- å¸è½½
  - componentWillUnmount()

#### ç»„ä»¶é€šä¿¡

- ç¥–å…ˆå’Œåä»£ç»„ä»¶é€šä¿¡
  - çˆ¶å­ç»„ä»¶
  - éçˆ¶å­ç»„ä»¶(context)
- å…„å¼Ÿç»„ä»¶
  - ä»¥çˆ¶ç»„ä»¶ä¸ºæ¡¥æ¢ å®ç°ä¸¤ä¸ªç»„ä»¶çš„é€šä¿¡

#### ç»„ä»¶æŠ½è±¡ä¸å¤ç”¨

- ç»§æ‰¿(A is B å­ç±»æ˜¯çˆ¶ç±»æ›´ç‹­éš˜çš„å®šä¹‰)

```js
class PureComponent extends Component {
  shouldComponentUpdate(nextProps, nextState) {
    const { props, state } = this;
    return shallowCompare(nextProps, props) && shallowCompare(nextState, state);
  }
}

class Deom1 extends Component {
  // ç»§æ‰¿çˆ¶ç±» shouldComponentUpdate
}

class Deom2 extends Component {
  // ç»§æ‰¿çˆ¶ç±» shouldComponentUpdate
}
```

- ç»„åˆ(java å®ç°ç»„åˆçš„æ–¹å¼æ˜¯æ¥å£ç»§æ‰¿)
- æŠ½å–å…¬å…±éƒ¨åˆ†

```js
// å†…éƒ¨è°ƒç”¨ æ‰‹å·¥æä¾›ä¸€å±‚ä»£ç†ï¼ˆ å¤„ç† this æŒ‡å‘å’Œå‚æ•°ä¼ é€’é—®é¢˜
const map = {
    run() {
        this.runState = true;
    }
    stop() {
        this.runState = false;
    }
};

class People {
    run(...args) {
        return map.run.call(this, ...args);
    }

    stop(...args) {
        return map.run.call(this, ...args);
    }
}

// æ‰¹é‡æ‹·è´
// å­˜åœ¨åé¢æ··å…¥çš„é‡åæ–¹æ³• ä¼šè¦†ç›–å‰é¢çš„æ–¹æ³•
function extends(obj1, obj2) {
    Object.keys(obj2).forEach(function(key) {
        obj1[key] = ojb2[key]
    })
}

class People {}

extends(People.prototype, map);
Object.assign(People.prototype, map);
```

- é«˜é˜¶ç»„ä»¶(æ¥æ”¶ç»„ä»¶ å¹¶è¿”å›ç»„ä»¶çš„ç»„ä»¶)

```js
// è°ƒç”¨ä¼ å…¥ç»„ä»¶
// åœ¨ç»„ä»¶å¤–å›´è¿›è¡Œä¸€äº›æ“ä½œ
function HOC1(InnerComponent) {
    return class WrapComponent extends Components {
        render() {
            <InnerComponent ...this.props >
                {this.props.children}
            </InnerComponent>
        }
    }
}

let Deom1 = class extends Components {

}

Deom1 = HOC1(Deom1)

// ç»§æ‰¿ä¼ å…¥ç»„ä»¶
// åœ¨ä¼ å…¥ç»„ä»¶çš„å†…éƒ¨è¿›è¡Œä¸€äº›æ“ä½œ(æ”¹å†™ render)
function HOC2(InnerComponent) {
    return class WrapComponent extends InnerComponent {}
}

let Deom2 = class extends Components {

}

Deom2 = HOC1(Deom2)

// ä¸¾ä¸ªğŸŒ°
function SetTimeoutHOC(InnerComponent) {
    return class WrapCompontent extends InnerComponent {
        componentWillMount() {
            super.componentWillMount();
            this.timeouts = [];
        },
        setTimeout() {
            super.componentWillMount();
            this.timeouts.push(setTimeout.apply(null, arguments))
        }
        componentWillUnmount() {
            super.componentWillUnmount();
            this.timeouts.forEach(clearInterval);
        }
    }
}

function SetIntervalHOC(InnerComponent) {
    return class WrapCompontent extends InnerComponent {
        componentWillMount() {
            super.componentWillMount();
            this.intervals = [];
        },
        setTimeout() {
            super.componentWillMount();
            this.intervals.push(setInterval.apply(null, arguments))
        }
        componentWillUnmount() {
            super.componentWillUnmount();
            this.intervals.forEach(clearInterval);
        }
    }
}

let Demo1 = class extends Components {

}

Deom1 = SetTimeoutHOC(SetIntervalHOC(Demo1))

```

**ç»§æ‰¿ ç»„åˆ é«˜é˜¶ç»„ä»¶é€šè¿‡ä¸‰ç§ä¸åŒçš„æ€è·¯ éƒ½å¯ä»¥è§£å†³ä»£ç é‡å¤çš„é—®é¢˜**

## è¸©å‘æŒ‡åŒ—

Qï¼š å½“ setState æ‰§è¡Œå®Œæ¯•å è¯»å– state ä¸­æ•°æ® å‘ç°æ•°æ®æœªè¢«æ›´æ–°
Aï¼š ä¸ºäº†æ€§èƒ½æå‡ å°†å¤šæ¬¡ setState æ“ä½œåˆå¹¶æˆä¸€æ¬¡(å¼‚æ­¥)
