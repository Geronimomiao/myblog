---
title: TCP滑动窗口传输
time:  2019-10-15
author: wsm
mail: 1030057982@qq.com
---

**Advertised window**
* 可接收的信息大小

* 发送方 
![enter description here](https://img.wsmpage.cn/learning/2019-10-15/1571128097504.png)

* 接收方
![enter description here](https://img.wsmpage.cn/learning/2019-10-15/1571128110039.png)

* 确认与重发的机制
	* 6、7、8、9 肯定都发了，但是 8、9 已经到了，但是 6、7 没到，出现了乱序，缓存着但是没办法 ACK
* 超时重试 
	* 每一个发送了，但是没有 ACK 的包，都有设一个定时器，超过了一定的时间，就重新尝试
	* 时间必须大于往返时间 RTT 采样 RTT 的波动范围，计算出一个估计的超时时间。由于重传时间是不断变化的，我们称为自适应重传算法
	* 每当遇到一次超时重传的时候，都会将下一次超时时间间隔设为先前值的两倍。两次超时，就说明网络环境差，不宜频繁反复发送
* 快速重传机制
	* 接收方收到一个序号大于下一个所期望的报文段时，就检测到了数据流中的一个间格，于是发送三个冗余的 ACK，客户端收到后，就在定时器过期之前，重传丢失的报文段
	* 接收方发现 6、8、9 都已经接收了，就是 7 没来，那肯定是丢了，于是发送三个 6 的 ACK，要求下一个是 7。客户端收到 3 个，就会发现 7 的确又丢了，不等超时，马上重发

* 流量控制
	* 发送方会定时发送窗口探测数据包 看是否有机会调整窗口的大小
	* 当接收方比较慢的时候，要防止低能窗口综合征，别空出一个字节来就赶快告诉发送方，然后马上又填满了，可以当窗口太小的时候，不更新窗口，直到达到一定大小，或者缓冲区一半为空，才更新窗口  


